---
description: Заполнение каталога Бипиума записями из Excel-таблицы.
---

# Импорт записей

## Импорт из Excel

В каталоги Бипиума можно импортировать записи из файла Microsoft Excel (.xlsx).

<figure><img src="../../../.gitbook/assets/1 (13).png" alt=""><figcaption></figcaption></figure>

Бипиум создает новые записи в каталоге соотнося наименование столбца в Excel-таблице (первую заполненную ячейку в столбце) с наименованием поля каталога. Если наименования совпадают, то Бипиум автоматически заполнит значения полей создаваемых записей значениями ячеек столбца Excel.

<figure><img src="../../../.gitbook/assets/2 (19).png" alt=""><figcaption></figcaption></figure>

Если вы хотите изменить правило соотношения полей каталога со столбцами из Excel, вы можете вручную соотнести поле со столбцом:

<figure><img src="../../../.gitbook/assets/3 (18).png" alt=""><figcaption></figcaption></figure>

## Типы импортируемых значений

Кроме импортирования текстовых и числовых значений, можно также импортировать значения других полей, например поля типа «Статус», Связанный каталог» и других. В этом случае поиск нужного значения будет произведен по полному совпадению его наименования и ячейки из столбца Excel.

Если наименования не совпадают, то система не сможет автоматически соотнести значение поля с ячейкой столбца Excel-таблицы. В этом случае вы можете самостоятельно выбрать доступное значение поля для импортируемой записи.

Например, в должности «Директор» в Excel-таблице произошла опечатка:

<figure><img src="../../../.gitbook/assets/10 (6).png" alt=""><figcaption></figcaption></figure>

Можно самостоятельно выбрать правильное значение:

<figure><img src="../../../.gitbook/assets/11 (5).png" alt=""><figcaption></figcaption></figure>

## Пример импорта записей

В каталоге «Лица» есть следующий набор полей:

<figure><img src="../../../.gitbook/assets/4 (12).png" alt=""><figcaption></figcaption></figure>

Записи в связанном каталоге «Предприятия (1)»:

<figure><img src="../../../.gitbook/assets/5 (12).png" alt=""><figcaption></figcaption></figure>

Записи в каталоге «Сотрудники»:

<figure><img src="../../../.gitbook/assets/8 (13).png" alt=""><figcaption></figcaption></figure>

Excel-файл для импорта в каталог «Лица»:

<figure><img src="../../../.gitbook/assets/6 (10).png" alt=""><figcaption></figcaption></figure>

Результат импортирования:

<figure><img src="../../../.gitbook/assets/7 (9).png" alt=""><figcaption></figcaption></figure>

## Право импортировать записи

Импортировать записи могут сотрудники с привилегией «Создавать записи» и выше. Подробнее в статье «[Привилегии](https://docs.bpium.ru/manual/rights/priviliges)». Также возможен вариант открытия доступа к каталогу без возможности просмотра записей в нем, но импорт при этом будет доступен. Реализуется данный механизм с использованием правовых видов, в качестве правила также должна быть выбрана привилегия «Создавать записи».&#x20;

## Другие методы импорта записей

В случаях, когда функционала стандартного импорта недостаточно, например, когда нужно импортировать только определенные записи по критерию или актуализировать существующие в Бипиуме записи, используйте сценарий автоматизации. Пошаговая инструкция [импорта данных из Excel.](https://docs.bpium.ru/manual/structure/catalogs/import-zapisei/import-iz-excel)

### Импорт из Excel с использованием сценария

{% embed url="https://1283378397-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-LACZmmM2xUWbZxyRr4s%2Fuploads%2FXUyMBTQoAscqA1B7VVBH%2F%D0%98%D0%BC%D0%BF%D0%BE%D1%80%D1%82%20%D0%B8%D0%B7%20excel%20(%D1%81%D1%82%D0%B0%D1%82%D1%8C%D1%8F).mp4?alt=media&token=7fbbebe2-e6ea-41f5-93c4-8e643f333a0e" %}

## Выбор каталога и файла для импорта

Чтобы импортировать данные перейдите в каталог, в который хотите импортировать данные и нажмите «Импорт из Excel».

<figure><img src="../../../.gitbook/assets/0 скрин.png" alt=""><figcaption></figcaption></figure>

Следующий шаг: Выберите импортируемый объект. По умолчанию пользователю доступен импорт только из .xlsx файлов.

<figure><img src="../../../.gitbook/assets/1 скрин.png" alt=""><figcaption></figcaption></figure>

## Настройка параметров импорта

После выбора импортируемого объекта перед вами появится таблица с «сырыми» данными. Они будут конвертированы в формат Бипиума, исходя из правил, задаваемых в заголовке каждого столбца.

<figure><img src="../../../.gitbook/assets/2 скрин.png" alt=""><figcaption></figcaption></figure>

Правила задаются при помощи прямого соответствия это значит, что:\
**Название столбца в excel — Название поля в структуре каталоге**

На выбор доступны все поля структуры каталога + служебное значение - «Не импортировать»**.**

<figure><img src="../../../.gitbook/assets/3 скрин.png" alt=""><figcaption></figcaption></figure>

Каждая строка таблицы может находиться в различных состояниях. Каждому состоянию соответствует свое значение служебного поля «Статус строки»:

| Значение поля      | Состояние строки                                                                                      |
| ------------------ | ----------------------------------------------------------------------------------------------------- |
| Определено         | Каждая ячейка строки удовлетворяет условиям корректности введенных данных (Строка без ошибок)         |
| Ошибка определения | Хотя бы одна ячейка строки не удовлетворяет условиям корректности введенных данных (Строка с ошибкой) |
| Импортировано      | Строка импортирована                                                                                  |
| Ошибка импорта     | Строку не удалось импортировать                                                                       |
| Не импортировать   | Строка исключена из списка импортируемых строк                                                        |
| Обработка          | Данные конвертируются                                                                                 |

Помимо индикации состояния строк, можно визуально определить в каких именно ячейках допущена ошибка, текст в таких ячейках красный. (При ошибке, текст в ячейке красный)**.**

Cтроки таблицы, кроме обладающих статусом «Импортировано» и «Не импортировать», «Обработка» можно редактировать. Но есть особенности:

* Когда вы исправите ошибку, текущие изменения будут применены ко всем ячейкам столбца. Исключение **—** пустые ячейки.
* При изменении корректно определенной ячейки, изменения будут применены только к изменяемой ячейке.

После установки правил импортирования данных, нажмите на кнопку «Импортировать» в правом нижнем углу.

<figure><img src="../../../.gitbook/assets/4 скрин.png" alt=""><figcaption></figcaption></figure>

## Что еще можно делать с данными

Импорт можно остановить. Для этого в системе есть кнопка «Пауза».

<figure><img src="../../../.gitbook/assets/5 скрин.png" alt=""><figcaption></figcaption></figure>

В правом нижнем углу указывается примерное время выполнения импорта.

Импорт также сопровождается индикационным статус баром. Полоска зеленого цвета показывает какие записи успешно имортированы, красная полоска показывает, что в процессе импорта есть ошибка.

Внизу каждого столбца указан процент успешно определенных ячеек.

<figure><img src="../../../.gitbook/assets/6 скрин.png" alt=""><figcaption></figcaption></figure>

Данные в таблице можно отфильтровать по статусу строк или по содержащимся в них данным.

<figure><img src="../../../.gitbook/assets/7 скрин.png" alt=""><figcaption></figcaption></figure>
