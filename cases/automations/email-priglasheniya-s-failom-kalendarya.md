# Email приглашения с файлом календаря

## 1. Введение <a href="#id-2-d0-bf-d1-80-d0-b8-d0-bd-d1-86-d0-b8-d0-bf-d1-80-d0-b0-d0-b1-d0-be-d1-82-d1-8b" id="id-2-d0-bf-d1-80-d0-b8-d0-bd-d1-86-d0-b8-d0-bf-d1-80-d0-b0-d0-b1-d0-be-d1-82-d1-8b"></a>

Отправка писем с приглашением на встречу с файлом календаря — способ автоматической отправки приглашений участникам встреч с прикрепленным ICS-файлом. К письму автоматически прикрепляется ICS-файл, который позволяет участникам одним кликом добавить встречу в свой календарь (Outlook, Google Calendar, Apple Calendar и др.).

<figure><img src="../../.gitbook/assets/изображение (5).png" alt=""><figcaption></figcaption></figure>

## 2. Принципы работы <a href="#id-2-d0-bf-d1-80-d0-b8-d0-bd-d1-86-d0-b8-d0-bf-d1-80-d0-b0-d0-b1-d0-be-d1-82-d1-8b" id="id-2-d0-bf-d1-80-d0-b8-d0-bd-d1-86-d0-b8-d0-bf-d1-80-d0-b0-d0-b1-d0-be-d1-82-d1-8b"></a>

Приглашения отправляются с использованием специального каталога, в записях которого фиксируются участники встречи, время проведения, место и описание мероприятия.

При создании записи в каталоге «Встречи» срабатывает сценарий по формированию календарного приглашения и отправке сообщения всем указанным участникам. Система автоматически генерирует ICS-файл с данными встречи и отправляет персональные приглашения на почтовые адреса участников.

&#x20;Каталог позволяет удобно планировать встречи путем создания новых записей и следить за историей.&#x20;

<figure><img src="../../.gitbook/assets/изображение (8).png" alt=""><figcaption></figcaption></figure>

## 3. Реализация <a href="#id-3-d1-80-d0-b5-d0-b0-d0-bb-d0-b8-d0-b7-d0-b0-d1-86-d0-b8-d1-8f" id="id-3-d1-80-d0-b5-d0-b0-d0-bb-d0-b8-d0-b7-d0-b0-d1-86-d0-b8-d1-8f"></a>

### 3.1. Настройка структуры каталога «Встречи» <a href="#id-31-d0-bd-d0-b0-d1-81-d1-82-d1-80-d0-be-d0-b9-d0-ba-d0-b0-d1-81-d1-82-d1-80-d1-83-d0-ba-d1-82-d1-83-d" id="id-31-d0-bd-d0-b0-d1-81-d1-82-d1-80-d0-be-d0-b9-d0-ba-d0-b0-d1-81-d1-82-d1-80-d1-83-d0-ba-d1-82-d1-83-d"></a>

Создайте каталог «Встречи», данный каталог будет содержать информацию о всех запланированных встречах. Создание записи в каталоге инициирует отправку приглашений участникам встречи. Настройка полей представлена ниже:

<figure><img src="../../.gitbook/assets/изображение (16).png" alt=""><figcaption></figcaption></figure>

**Создано** (Дата)\
Описание: содержит информацию о дате создания записи встречи.\
Настройки: Дата с временем, по умолчанию текущая дата.\
id: createdAt

**Название встречи** (Текст)\
Описание: Название/тема встречи.\
id: title

**Дата начала** (Дата)\
Описание: Дата и время начала встречи.\
Настройки: Дата с временем, обязательное поле.\
id: startDate

**Дата окончания** (Дата)\
Описание: Дата и время окончания встречи.\
Настройки: Дата с временем, обязательное поле.\
id: endDate

**Место проведения** (Текст)\
Описание: Место проведения встречи (адрес, переговорная, ссылка на видеоконференцию).\
id: location

**Описание** (Многострочный текст)\
Описание: Подробное описание встречи, повестка дня.\
id: description

**Участники** (Сотрудник)\
Описание: Сотрудники, которые должны участвовать во встрече.\
Настройки: Множественный выбор, обязательное поле.\
id: participants

**Важно**. В технических свойствах ID полей должно быть задано согласно скриншоту выше.

#### 3.3. Настройка автоматизации <a href="#id-32-d0-bd-d0-b0-d1-81-d1-82-d1-80-d0-be-d0-b9-d0-ba-d0-b0-d0-b0-d0-b2-d1-82-d0-be-d0-bc-d0-b0-d1-82-d" id="id-32-d0-bd-d0-b0-d1-81-d1-82-d1-80-d0-be-d0-b9-d0-ba-d0-b0-d0-b0-d0-b2-d1-82-d0-be-d0-bc-d0-b0-d1-82-d"></a>

**3.3.1. Создание записи сценария**

Создайте новую запись в системном каталоге «Сценарии». В поле «Сценарий» прикрепите следующий файл:

{% file src="../../.gitbook/assets/ics_generation (1).bpmn" %}

<figure><img src="../../.gitbook/assets/изображение (6).png" alt=""><figcaption></figcaption></figure>

**3.3.2. Создание записи события**

Перейдите в системный каталог «События» (обычно он находится в отделе Управление) и создайте новую запись. Заполните запись следующим образом:

<figure><img src="../../.gitbook/assets/изображение (13).png" alt=""><figcaption></figcaption></figure>

**Событие:** Уведомление о создании записи\
**Каталог:** Встречи

В поле «Выполнить» в качестве сценария выберите созданный на предыдущем шаге сценарий.

**3.3.3. Настройка файла сценария**

Сценарий для отправки календарных приглашений выглядит следующим образом:

<figure><img src="../../.gitbook/assets/изображение (14).png" alt=""><figcaption></figcaption></figure>

В загруженном сценарии нет необходимости редактировать компоненты, если вы задали ID-полей также как в пункте 3.1 при создании каталога "Встречи".

**Компонент «Генерация ICS-файла».**

В этом компоненте автоматически формируется содержимое календарного файла на основе данных встречи.

**Компонент «Получение почты сотрудника».**

Компонент в цикле получает список всех участников встречи из поля «Участники» и их контактную информацию для рассылки приглашений.

**Компонент «Отправка почты».**

Адрес сервера и Порт: укажите действующий логин и пароль почтового ящика в кавычках.\
В некоторых случаях вместо основного пароля используется **пароль приложения** (например в Яндекс.Почте), который необходимо сгенерировать в настройках безопасности почтового сервиса.

Дополнительно можете ознакомиться с настройками параметров подключения к почтовым сервисам по следующей ссылке, раздел параметры подключения к популярным сервисам.&#x20;

{% embed url="https://docs.bpium.ru/manual/processes/scripts/components/poluchenie-pochty#yandeks.pochta" %}

## 4. Тестирование <a href="#id-4-d1-82-d0-b5-d1-81-d1-82-d0-b8-d1-80-d0-be-d0-b2-d0-b0-d0-bd-d0-b8-d0-b5" id="id-4-d1-82-d0-b5-d1-81-d1-82-d0-b8-d1-80-d0-be-d0-b2-d0-b0-d0-bd-d0-b8-d0-b5"></a>

#### 4.1. Создание тестовой встречи <a href="#id-41-d1-81-d0-be-d0-b7-d0-b4-d0-b0-d0-bd-d0-b8-d0-b5-d1-82-d0-b5-d1-81-d1-82-d0-be-d0-b2-d0-be-d0-b9-d" id="id-41-d1-81-d0-be-d0-b7-d0-b4-d0-b0-d0-bd-d0-b8-d0-b5-d1-82-d0-b5-d1-81-d1-82-d0-be-d0-b2-d0-be-d0-b9-d"></a>

Создайте запись в каталоге «Встречи». Заполните все обязательные поля: название встречи, дату и время начала и окончания, выберите участников из каталога сотрудников. Пример заполнения представлен ниже:

<figure><img src="../../.gitbook/assets/изображение (17).png" alt=""><figcaption></figcaption></figure>

После заполнения всех необходимых полей сохраните запись.

#### 4.2. Проверка результата <a href="#id-42-d0-bf-d1-80-d0-be-d0-b2-d0-b5-d1-80-d0-ba-d0-b0-d1-80-d0-b5-d0-b7-d1-83-d0-bb-d1-8c-d1-82-d0-b0-d" id="id-42-d0-bf-d1-80-d0-be-d0-b2-d0-b5-d1-80-d0-ba-d0-b0-d1-80-d0-b5-d0-b7-d1-83-d0-bb-d1-8c-d1-82-d0-b0-d"></a>

После сохранения записи автоматически срабатывает сценарий отправки календарных приглашений.

При успешной отправке всем участникам встречи будет отправлено персональное письмо с календарным приглашением.

<figure><img src="../../.gitbook/assets/изображение (19).png" alt="" width="563"><figcaption><p>Результат работы данной автоматизации.</p></figcaption></figure>
