---
description: Автоматический импорт данных из Excel-таблицы в систему Бипиума.
---

# Импорт данных из Excel

## 1. **Принцип работы**

![](<../../.gitbook/assets/Untitled - Frame 1.jpg>)

При нажатии на кнопку «Конвертировать» в каталоге «Импорт клиентов» запускается сценарий «Конвертировать документ». Сценарий конвертирует Excel таблицу и полученные данные записывает в каталог «Клиенты**».**

## **2. Реализация**

### **2.1. Настройка структуры данных**

#### **2.1.1.** Настройка каталога «Клиенты»

Создайте каталог «Клиенты», данный каталог является справочником всех клиентов в системе. При создании каталога нужно добавить и настроить поля следующим образом:

![](<../../.gitbook/assets/каталог Клиенты.jpg>)

* **Фамилия** (текст).\
  Описание: хранит фамилию клиента.
* **Имя** (текст).\
  Описание: хранит имя клиента.
* **Отчество** (текст).\
  Описание: хранит отчество клиента.
* **Телефон** (контакт).\
  Описание: хранение номера телефона клиента.\
  Настройки: тип поля — «Телефон».
* **Email** (контакт).\
  Описание: хранение номера телефона клиента.\
  Настройки: тип поля — «Электронная почта»

#### 2.1.2. Настройка каталога «Импорт клиентов»

Создайте каталог «Импорт клиентов». В данный каталог загружается Excel файл с информацией о клиентах. Заполните каталог следующими полями:

![](<../../.gitbook/assets/каталог Импорт.jpg>)

* **Excel** (файл).\
  Описание: В данное поле загружается Excel файл с информацией о клиентах.
* **Конвертировать** (статус).\
  Описание: При выборе статуса «конвертировать», данные с Excel файла импортируются в каталог «клиенты».

### 2.2. **Настройка автоматизации**

#### **2.2.1.** Создание и настройка события

Для создания события нужно зайти в каталог «События» (обычно он находится в отделе Управление). Нажать кнопку Добавить и заполнить карточку события как указано на скриншоте ниже.

![](../../.gitbook/assets/Событие.jpg)

В поле «Отслеживать поля» впишите ID поля «Конвертировать» из каталога «Импорт клиентов».

#### 2.2.2. **Создание записи сценария**

Создайте сценарий в каталоге «Сценарии». Данный сценарий предназначен для импорта данных из Excel файла в каталог **«**Клиенты». При создании записи сценария прикрепите к нему файл ниже, нажав на кнопку «Загрузить…»:

{% file src="../../.gitbook/assets/excel.bpmn" %}

![](https://lh4.googleusercontent.com/-1xX1YaxpKuqgma8Sz2Na89VP7wpQ5vGZ90XQySjiCmixv8laVDE9-aou7PVJwB4TZcFfjGKLFjZ2d258Uh5Jw\_oqs\_oWNVx1HAOQsAvFbKp7scK4ZhjavvkXHciyIeNLU\_o\_AxTe74biKVYLg)

#### 2.2.3. **Настройка файла сценария**

Откройте файл сценария в поле «Сценарий» и отредактируйте следующие компоненты, согласно комментариям внутри них:

![Компонент «Создать запись».](https://lh6.googleusercontent.com/kKi3dwpV3ceanII6jtOdwPYMrSPNjxVoNy766-6WnY1Ogv999q1G-uLfh3-Q1BDfjnv6kqX\_yKoMQMF72TYHqxsSCI3nOZeW3pll6EAA2wH1p1Ms\_FymQiyqXG3Cm6jmJiO9yX\_Bzk586wx9SQ)

Компоненты сценария, в которые нужно внести изменения:

* **Каталог**: Укажите название каталога в который должны импортироваться данные**.**
* **Значения полей**: Замените API из каталога в который должны импортироваться данные.
* **Значения полей**: Замените название листа и столбец из Excel файла.

![](https://lh5.googleusercontent.com/uNS-rnOw0cWgvpEqulr\_z0SMREtNsGj7H14Wnqq0uuYQoVvzZhxzX1HABBXd0gPMnVQ6kb9LOlLxLSSvkKzYVsiTPeiLqWtWggm0HmhTu-5o6BrKTb1xlpKonwMinuvs6MGfcVD33\_XHx6X6Sw)

## 3. **Тестирование**

### **3.1. Каталог «Импорт данных»**

Загрузите Excel файл в каталог «Импорт клиентов», сохраните и выберите статус «конвертировать**»**.

![](https://lh4.googleusercontent.com/qck8MBNCGwgdvsr\_MJ2dR8XmTbI9WghHxDiVNwAdOvrW00LRQtQriXvI9k3AoQ3HPBG3muz459UICSKGA8zkv4TSOWgpo7X6KSvyBYUd\_KeM76GGoBPSxDyZ7t5jCDO-VA5ZGAw9RKoW-HoxFw)

Пример заполнения Excel файла представлен ниже:

![](https://lh4.googleusercontent.com/s7Lw8URcNsaf2RU1HbIq585FpZQU-sGl1MwlwltS5\_fvcxBi4HTYer8OS7RaBGSKG--fbFlnNTz4rorm189ZJTx7te8hAjya7R7Oz5YUTTHLtkL\_Wt-\_BI\_FsgICZ\_2Zg5lofXw9ntKruNqoLw)

### 3.2. **Каталог «Клиенты»**

Результат импорта:

![](https://lh5.googleusercontent.com/vO-q\_og7p1wrcDStAyFof7DqutQkM9BBNN3Rs0nsrS4QIedaCeBXxqExNhkWIosAvYK5txEAczkb5erB53OqKHZUxV6xdY-NWJoe7Upxvtt6GatNcOSfA2XEhVcUOQqdHyPx-txa8W4F\_LQFYA)
