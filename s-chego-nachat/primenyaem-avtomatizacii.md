# Применяем автоматизации

У нас есть собранная минимальная система с настроенными каталогами для данных, отчётами по данным, а также настроенными правами доступа. Не хватает лишь автоматизаций. Так давайте добавим в систему еще и небольшую автоматизацию.&#x20;

Автоматизации в Бипиум - это реакции на изменения данных в системе. Поэтому мы должны описать для системы правила: \
&#x20;   1\. Изменения каких именно данных отслеживаем - за это отвечает каталог [События](../bpium-setup/processes/events/)\
&#x20;   2\. Что после этих изменений мы должны сделать - за это отвечает каталог [Сценарии](../bpium-setup/processes/scripts/) \
Например, мы хотим при назначении ответственного менеджера в заказ, отправить данному сотруднику уведомление в системе о назначенном заказе. Рассмотрим этот кейс ниже&#x20;

## Отправка уведомления ответственному сотруднику

Для начала нужно определиться с объектом, в котором мы отслеживаем изменения - это каталог Заказы, но нас интересуют не все данные из заказа, а лишь одно поле - Ответственный менеджер. Для этого сначала настроим каталог Заказы, а также посмотрим id нужного нам поля. В нашем случае  id нужного нам поля 8.

<figure><img src="../.gitbook/assets/image (206).png" alt=""><figcaption><p>Настройка автоматизаций. id поля «Ответственный менеджер» из каталога «Заказы»</p></figcaption></figure>

\
Опишем правило отслеживания нужного нам поля в каталоге События:

1. В разделе Управление в каталог События нажмите кнопку "Создать", для добавления новой записи в каталоге События
2. Укажите Название - оно произвольное
3. В поле "Каталог" выберите из списка каталог "Заказы"
4. Отметьте в поле "События" галочки: "Уведомление о создании записи" и "Уведомление об изменении записи"
5. В поле "Отслеживать поля" укажите id поля "Ответственный менеджер" из каталога "Заказы". id-поля можно посмотреть в настройках структуры каталога. В нашем примере - это 8
6. Сохраните запись

<figure><img src="../.gitbook/assets/image (220).png" alt=""><figcaption><p>Автоматизация. Отправка уведомления сотруднмику в чате</p></figcaption></figure>

Мы описали для системы правило для отслеживания изменений в нужных нам данных. Теперь необходимо описать действия, которые должны быть выполнены при возникновении данных изменений. Для этого:

1. В разделе Управление в каталоге Сценарии нажмите кнопку "Добавить" для добавления новой записи
2. Укажите Название - оно также произвольное, но мы рекомендуем, чтобы оно было информативным
3. Нажмите кнопку "Создать" в поле "Сценарий", у вас откроется BPMN-схема для описания необходимых действий в системе, с помощью готовых для этого компонентов. Подробное описание каждого компонента можно найти [по ссылке](https://docs.bpium.ru/manual/processes/scripts/components)

<figure><img src="../.gitbook/assets/image (208).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (209).png" alt=""><figcaption></figcaption></figure>

4. В данном примере мы будем использовать лишь пару компонентов:

* [Шлюз «ИЛИ» (условное ветвление)](https://docs.bpium.ru/manual/processes/scripts/components/exclusivegateway)
* [Отправить сообщение](https://docs.bpium.ru/manual/processes/scripts/components/otpravit-soobshenie)

Условие нам необходимо для того, чтобы проверить а указан ли Ответственный менеджер, ведь событие будет срабатывать не только при добавлении и изменении ответственного менеджера в заказе, но и при его удалении из заказа, так как данное действие также является изменением данных в интересующем нас каталоге и поле.

Добавляем компоненты и переименовываем.&#x20;

<figure><img src="../.gitbook/assets/image (210).png" alt=""><figcaption><p>Автоматизация. Компоненты сценария</p></figcaption></figure>



<figure><img src="../.gitbook/assets/image (221).png" alt=""><figcaption><p>В первой ветке условия указываем, что в поле «Ответственный сотрудник» есть данные.</p></figcaption></figure>

<figure><img src="../.gitbook/assets/image (215).png" alt=""><figcaption><p>Вторую ветку условия просто отмечаем потоком по умолчанию.<br>Сценарий пойдет по данной ветке, если не выполнится условие в первой ветке.</p></figcaption></figure>

<figure><img src="../.gitbook/assets/image (222).png" alt=""><figcaption><p>В компоненте "Отправить сообщение" указываем данные согласно скриншоту</p></figcaption></figure>

5. Нажмите кнопку "Сохранить" в правом верхнем углу для сохранения файла сценария
6. Нажмите кнопку "Сохранить" в правом верхнем углу для сохранения записи сценария

Теперь нужно привязать событие и сценарий между собой. Откройте ранее созданное событие и в поле "Выполнить" выберите созданный сценарий, после чего сохраните запись события.

<figure><img src="../.gitbook/assets/image (217).png" alt=""><figcaption><p>Автоматизация. Выбор сценария в событии</p></figcaption></figure>

## Проверка

Перейдите в каталог Заказы и измените ответственного менеджера в одном из существующих заказов, либо создайте новый заказ, указав ответственного менеджера. У ответственного менеджера будут следующие уведомления в системе



<figure><img src="../.gitbook/assets/image (223).png" alt=""><figcaption><p>Автоматизации. Уведомление сотрудника в системе</p></figcaption></figure>

<figure><img src="../.gitbook/assets/image (224).png" alt=""><figcaption><p>Автоматизации. Уведомление сотрудника в чате</p></figcaption></figure>
