# Урок 3. Валидация данных

Вести учет, хранить и не потерять контактные данные — важно для каждого предприятия. Покажем как можно настроить валидацию данных при создании анкеты клиента.

{% embed url="https://vimeo.com/1024366553" %}

## Кейс

Система автоматически проверяет заполнение контактных данных лида, в случае если не заполнено — запрещает создание записи и оповещает об этом сотрудника.

## Навыки

В этом уроке будут рассмотрены следующие **компетенции** и их навыки:

* **Принципы Бипиума:** понимание устройства сценария
* **События:** запрос создания записи
* **Сценарии:** входные параметры, выходные параметры
* **Компоненты:** найти записи, условие, назначение переменных
* **Javascript:** операторы сравнения, массивы: методы pop/push, shift/unshift, length
* **Использование документации:** выходные параметры, типы данных

***

## В этом уроке

#### **Слайд: События запроса (0:24)**

Срабатывают перед сохранением изменений в каталог, то есть была отправлена команда сохранения, но в каталоге этих изменений еще нет.

Каждое событие запускает процесс, передавая определенные входные параметры и ожидает от процесса в ответ определенных выходных переменных для возврата их инициатору события

**Входные параметры событий запроса создании записи:**

* **event**(объект) — параметры сработавшего события.
* **script**(объект) — параметры запущенного сценария.
* **user**(объект) — сотрудник вызвавший событие.
* **catalogId** (строка) — идентификатор каталога, в котором хотят создать запись.
* **values** (объект) — коллекция значений заполненных полей созданной записи. Ключи объекта — идентификаторы (ID) заполненных полей.

**Выходные параметры событий запроса:**

* **$status** (число) — код http-ответа:\
  &#x20;    **200** — разрешить операцию\
  &#x20;    **4xx** (например, 400) — запретить операцию и выдать ошибку
* **$body** (объект) — объект с дополнительными параметрами:\
  &#x20;   **message** (строка) — сообщение для отображения сотруднику, в случае запрета.

#### **Демонстрация: Описание кейса (2:17)**

Система автоматически проверяет заполнены ли контактные данные лида, в случае если не заполнено - запрещает создание записи и оповещает об этом сотрудника.

#### **Демонстрация: Создание события (3:09)**

1. В отделе «Управление» в каталоге «События» добавьте новую запись (событие, по которому будет запускаться процесс).
2. Укажите название. Например, ту задачу, которую выполняет процесс.
3. Выберите каталог, в котором хотите отслеживать изменение записей.
4. Выберите тип события для запуска сценария.&#x20;
5. В поле «Выполнить» выберите или создайте новый сценарий.

#### **Демонстрация: Создание сценария (3:50)**

1. В отделе «Управление» в каталоге «Сценарии» добавьте новую запись.
2. Укажите название сценария и нажмите «создать» в поле «Сценарий».
3. Нарисуйте сценарий: из панели компонентов выберите требуемые и расположите их в необходимой последовательности, задайте их свойства.

Компоненты:

* **Условие** — компонент может использоваться для ветвления процесса (иметь несколько условных выходов) и для синхронизации (иметь несколько входов).
* **Назначение переменных** — используется для сохранения значений в переменные на определенном этапе выполнения сценария.

***

## Домашнее задание

Для расширения знаний и подготовки к следующим урока изучите материалы:

* Описание событие запроса\
  ‍[https://docs.bpium.ru/processes/events/datachanged#zapros-na-sozdanie-zapisi-before-create](https://docs.bpium.ru/processes/events/datachanged#zapros-na-sozdanie-zapisi-before-create)
* Описание операторов сравнения в Javascript\
  [https://learn.javascript.ru/comparison](https://learn.javascript.ru/comparison)
* Описание компонента "Условие"\
  [https://learn.javascript.ru/ifelse](https://bpium.ru/learn-scripts/lesson-3)
* Описание компонента "Назначение переменных"\
  ‍[https://docs.bpium.ru/processes/scripts/components/setvariables](https://docs.bpium.ru/processes/scripts/components/setvariables)
