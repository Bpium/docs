# Урок 2. Первая автоматизация изнутри

Если рутинные процессы компании отнимают много времени и ресурсов, их можно автоматизировать. Разберем события, сценарии и настроим первую автоматизацию.

{% embed url="https://vimeo.com/1024366341" %}

## Кейс

Система автоматически закрепляет ответственного сотрудника за заявкой, с которой он начал работать.

## Навыки

В этом уроке будут рассмотрены следующие **компетенции** и их навыки:

* **Принципы Бипиума:** понимание устройства событий
* **События:** уведомление об изменении записи, отслеживаемые поля
* **Сценарии:** использования компонентов, входные параметры
* **Компоненты:** начало процесса, конец процесса, изменить запись
* **Javascript:** объекты, массивы
* **Использование документации:** входные параметры, типы данных

***

## В этом уроке

#### **Слайд: События уведомления (0:29)**

Срабатывают после сохранения изменений в каталоге, то есть после создания, изменения, удаления записи.

Каждое событие запускает процесс, передавая определенные входные параметры и ожидает от процесса в ответ определенных выходных переменных для возврата их инициатору события

**Входные параметры событий уведомления о изменении записи:**

* **event**(объект) — параметры сработавшего события.\
  &#x20;   **id** (строка) — идентификатор события в каталоге Событий.\
  &#x20;   **type** (строка) — название типа события.\
  &#x20;   **async** (булево) — признак запуска: true — асинхронно, false — синхронно.
* **script**(объект) — параметры запущенного сценария.\
  &#x20;   **id** (строка) — идентификатор сценария в каталоге Сценарии.
* **user**(объект) — сотрудник вызвавший событие.\
  &#x20;   **id** (строка) — идентификатор сотрудника или null, если вызвал другой процесс.
* **catalogId**(строка) — идентификатор каталога, в котором изменили запись.
* **recordId**(строка) — идентификатор измененной записи.
* **values**(объект) — коллекция значений измененных полей измененной записи. Ключи объекта — идентификаторы (ID) измененных полей. Формат описан ниже.
* **prevValues**(объект) — коллекция предыдущих значений всех полей записи. Формат аналогичен объекту values.

#### **Слайд: Объект (2:38)**

Объект - это набор свойств, и каждое свойство состоит из имени и значения, ассоциированного с этим именем.

#### **Слайд: Массив (3:32)**

Массив - это структура данных для хранения упорядоченных коллекций.

#### **Демонстрация: Описание кейса (4:18)**

Система автоматически закрепляет ответственного сотрудника за заявкой, с которой он начал работать.

#### **Демонстрация: Создание события (5:04)**

1. В отделе «Управление» в каталоге «События» добавьте новую запись (событие, по которому будет запускаться процесс).
2. Укажите название. Например, ту задачу, которую выполняет процесс.
3. Выберите каталог, в котором хотите отслеживать изменение записей.
4. Выберите тип события для запуска сценария.&#x20;
5. В поле «Выполнить» выберите или создайте новый сценарий.

#### **Демонстрация: Создание сценария (6:55)**

1. В отделе «Управление» в каталоге «Сценарии» добавьте новую запись.
2. Укажите название сценария и нажмите «создать» в поле «Сценарий».
3. Нарисуйте сценарий: из панели компонентов выберите требуемые и расположите их в необходимой последовательности, задайте их свойства.

Компоненты:

* **Начало процесса** — стартовое событие указывает на то, в какой точке берет начало тот или иной процесс. Процесс запускается с входными переменными, которые зависят от типа события.
* **Конец процесса** — останавливает процесс и передает все переменные, которые были созданы во время выполнения процесса, обратно в Бипиум. В зависимости от типа события необходимо вернуть определенную структуру параметров, которую ждет Бипиум в ответ.
* **Изменить запись** — используется для изменения записей в Бипиуме. Процессы изменяют записи минуя правовую политику и могут изменить любую запись в любом каталоге.

***

## Домашнее задание

Для расширения знаний и подготовки к следующим урока изучите материалы:

* Описание событий\
  [https://docs.bpium.ru/processes/events/datachanged](https://docs.bpium.ru/processes/events/datachanged)
* Описание объекта как тип данных в Javascript\
  [https://learn.javascript.ru/object](https://learn.javascript.ru/object)
* Описание массива как тип данных в Javascript\
  [https://learn.javascript.ru/array](https://learn.javascript.ru/array)
* Описание компонента "Изменить запись"\
  [https://docs.bpium.ru/processes/scripts/components/createrecord#sintaksis-ukazaniya-znacheniya-polei](https://bpium.ru/learn-scripts/lesson-2)
