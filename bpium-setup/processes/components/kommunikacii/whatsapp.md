# WhatsApp

Компонент «WhatsApp» позволяет автоматически отправлять сообщения, медиафайлы и другие данные в чаты WhatsApp прямо из бизнес-процессов Bpium. Это мощный инструмент для мгновенных уведомлений клиентов, оповещений сотрудников и автоматизации коммуникаций.

## Свойства

### Секция «Подключение» <a href="#sekciya-podklyuchenie" id="sekciya-podklyuchenie"></a>

Перед использованием компонента требуется настройка авторизации.

* Авторизационный токен (обязательное) - Ключ доступа для интеграции с WhatsApp API. Выберите заранее настроенное подключение из списка доступных. Чтобы получить токен ознакомьтесь с правилами работы сервиса токенов Bpium.&#x20;

### &#x20;Секция «Параметры»

* **Действие**  — Выберите действие, которое должен выполнить компонент. Доступные действия:
  * Отправить сообщение
  * Отправить геолокацию
  * Отправить контакт
  * Отправить реакцию на сообщение
  * Переслать сообщение
  * Изменить сообщение
  * Удалить сообщение
* **Диалог** — Уникальный идентификатор чата в WhatsApp, куда будет отправлено сообщение. Это может быть номер телефона в международном формате (например, "+79001234567") или идентификатор группового чата.
* **Текст** — Текстовая часть отправляемого сообщения. Поддерживаются статический текст и динамические данные через выражения из процесса.
* **Вложения** — Позволяет прикрепить к сообщению файлы (изображения, документы, видео, аудио). Для загрузки файла укажите выражение, которое возвращает его fileId (Формат: массив объектов вида `[{ title: "...", url: "https://..." }, ... ]`).
* **Формат отправки вложений** — Определяет способ отправки медиафайлов:
  * Медиа
  * Документ

### &#x20; Секция «Результат»

Результат работы компонента можно сохранить для последующего использования в процессе.

* Сохранить в — Укажите имя переменной, в которую будет записан ответ от WhatsApp API. В переменной сохранится объект с данными отправленного сообщения (например, его уникальный идентификатор), что полезно для дальнейших операций с сообщением (редактирование, удаление, добавление реакций).

## Получение токена

Откройте [tokens.bpium.ru](https://tokens.bpium.ru/) и выберите сервис WhatsApp.&#x20;

<figure><img src="../../../../.gitbook/assets/Скриншот сделанный 2025-12-11 в 15.56.12.png" alt=""><figcaption></figcaption></figure>

В открывшемся окне Вы получите QR-код который необходимо будет отсканировать с того мобильного устройства, которое вы хотите привязать в качестве инструмента для WhatsApp-коммуникации.

Для этого зайдите в свое приложение WhatsApp и перейдите в раздел Связанные устройства, далее нажмите на кнопку `"+ Связывание устройства"` и отсканируйте полученный ранее QR-код.

После этого сервис токенов Bpium вернет вам ключ, который необходимо будет добавить в служебный каталог "Доступы к сервисам" для последующего выбора его в самом компоненте.

## Пограничные события

![](../../../../.gitbook/assets/boundary_any.png)

Компонент поддерживает 2 типа пограничных событий:

* Ошибка — выход из компонента, если произошла какая-либо ошибка
* Таймаут — выход из компонента, спустя заданное ограничение по времени

Если компонент завершился с ошибкой, но на нем не было пограничного события, то процесс завершается. Сообщение ошибки возвращается в результатах процесса.

## Пример использования

### Напоминание о записи на прием

Цель: За 24 часа до запланированного приема отправить напоминание клиенту в WhatsApp.

1. Создайте сценарий, инициируемый по расписанию для каталога «Записи на прием»**.**
2. Добавьте компонент «WhatsApp» в холст процесс&#x430;**.**
3. Настройте подключени&#x435;**:** в поле Авторизационный токен выберите заранее настроенное подключение к WhatsApp API.
4. Заполните параметр&#x44B;**:**

*  Действие:    Отправить сообщение
* Диалог:    allValues.clientPhone (номер телефона клиента из записи)
* Текст:  Добрый день, ${allValues.clientName}! Напоминаем о вашей записи на завтра, ${allValues.appointmentDate}, в ${allValues.appointmentTime}. Специалист: ${allValues.specialistName}. Будем ждать вас!

4. Сохраните сценарий.

Теперь за сутки до визита клиент получит автоматическое напоминание в WhatsApp со всеми деталями записи.
