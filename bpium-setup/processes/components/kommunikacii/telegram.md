# Компонент Telegram

Компонент «Telegram» позволяет автоматически отправлять сообщения и медиафайлы в чаты и каналы Telegram прямо из бизнес-процессов Bpium. Это идеальный инструмент для мгновенных уведомлений о новых заявках, изменениях статусов или для отправки ежедневных отчетов. Позволяется отправка, как с личных аккаунтов так и посредством ботов полученных от BotFather телеграма.

#### Общие свойства

* Название (обязательное) — Уникальное имя компонента для его идентификации внутри процесса.
* Описание (необязательное) — Дополнительная информация о том, для чего используется этот компонент.
* Область применения: Автоматизация, Уведомления, Интеграции

## Подключение

Перед использованием компонента его необходимо авторизовать.

* Авторизационный токен (обязательное) — Это ключ доступа вашего аккаунта/бота. Чтобы получить токен ознакомьтесь с правилами работы сервиса токенов bpium. Подробнее про [Сервис получения токенов](https://docs.bpium.ru/~/revisions/RvJyhyxrmfCKm4AXIS42/bpium-setup/processes/components/kommunikacii/komponent-telegram/sozdanie-tokena).
* Тип подключения (обязательное) — Определяет контекст, от имени которого будет отправлено сообщение. Доступные варианты: Пользователь, бот.

<figure><img src="../../../../.gitbook/assets/image (230).png" alt=""><figcaption><p>Автоматизации: Компонент Telegram</p></figcaption></figure>

## Заполнение параметров

<figure><img src="../../../../.gitbook/assets/image (232).png" alt=""><figcaption><p>Автоматизации: Компонент Telegram</p></figcaption></figure>

* **Действие**  — Выберите действие, которое должен выполнить компонент. На данный момент доступны следующие действия ”Отправить сообщение, Отправить геолокацию, Отправить контакт, Переслать сообщение, Изменить сообщение, Удалить сообщение, Получить диалоги, Получить профиль, Получить сообщения”.
* **Диалог** — Уникальный идентификатор чата, куда будет отправлено/получено сообщение. Это может быть @username пользователя или публичного канала, либо числовой chat\_id группового чата или личного диалога.
* **Текст**  — Текстовая часть отправляемого сообщения. Вы можете использовать статический текст или динамические данные, подставляя значения через выражения и переменные из процесса (например, allValues.message).
* **Формат текста** — Позволяет выбрать разметку для текста. Доступные варианты: Markdown или HTML. Используйте этот параметр, чтобы добавить в сообщение жирный шрифт, курсив, списки или ссылки.
* **Вложения** — Позволяет прикрепить к сообщению файлы (изображения, документы, видео и т.д.). Для загрузки файла укажите выражение, которое возвращает его fileId (Формат: массив объектов вида \[ { title: "...", url: "https://..." }, ... ]).
* Ответить на сообщение — Позволяет отправить сообщение как ответ на конкретное другое сообщение в чате. Для этого укажите message\_id сообщения, на которое нужно ответить.
* ID сообщения — Дополнительное поле, заполняется при выборе опции Ответить на сообщение.
* Отправить без уведомления — Если эта опция активна, сообщение будет отправлено «бесшумно». Пользователи в чате не получат звукового уведомления или push-пуш.

<figure><img src="../../../../.gitbook/assets/image (235).png" alt=""><figcaption><p>Автоматизации: Компонент Telegram</p></figcaption></figure>

#### Поля для заполнения при типе подключения Бот:

* **Кнопки** — параметр доступен только для рассылки ботами

Объект вида:

```
Inline-клавиатура: { "inline_keyboard": [[{ "text": 
"Открыть сайт", "url": "https://example.com" }]] }; 

 Reply-клавиатура: { "keyboard": [[{ "text": "Привет" }, 
 { "text": "Локация", "request_location": true }]], "resize": true }; 
 Удалить клавиатуру: { "remove_keyboard": true}.
```

<figure><img src="../../../../.gitbook/assets/image (236).png" alt=""><figcaption><p>Автоматизации: Компонент Telegram</p></figcaption></figure>

#### Поля для подключения при типе подключения Пользователь:

* **Формат отправки вложений** — Позволяет выбрать формат: Markdown / HTML
* Отправить позже —  Если эта опция активна, сообщение будет отправлено в заданную Дату.
* Дата отправки — Дополнительное поле, заполняется при выборе опции Отправить позже.

<figure><img src="../../../../.gitbook/assets/image (234).png" alt=""><figcaption><p>Автоматизации: Компонент Telegram</p></figcaption></figure>

## Результат

Результат работы компонента можно сохранить в переменную процесса для дальнейшего использования в логике.

* **Сохранить результат в** —  Укажите имя переменной, в которую будет записан ответ от сервера Telegram.&#x20;

В эту переменную сохранится объект с данными отправленного сообщения (например, его уникальный message\_id). Это полезно, если вы планируете later редактировать это сообщение или отвечать на него в рамках этого же процесса.

<figure><img src="../../../../.gitbook/assets/image (233).png" alt=""><figcaption><p>Автоматизации: Компонент Telegram</p></figcaption></figure>

## Вариант использования

### &#x20;Уведомление клиента о статусе заказа

Цель: При изменении статуса заказа на «Готов к выдаче» отправить уведомление клиенту в «Telegram».





1. Создайте сценарий, инициируемый изменением статуса в каталоге «Заказы».
2. Добавьте компонент «Telegram» в холст процесса.
3. Настройте подключение: в поле Авторизационный токен выберите заранее настроенное подключение к Telegram API.
4. Заполните параметры:

*  Действие:    Отправить сообщение
* Диалог:    allValues.phone (номер телефона клиента из записи)
* Текст:   Уважаемый клиент! Ваш заказ № ${allValues.goods}, готов к выдаче. Ждем вас по адресу: г. Казань, ул. Примерная, д. 1

4. Сохраните сценарий.

Теперь при смене статуса заказа клиент будет автоматически получать уведомление в WhatsApp с актуальной информацией о его заказе.

