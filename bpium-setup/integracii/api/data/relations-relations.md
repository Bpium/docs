---
description: Ресурс Relations - хранит связи между записями.
---

# Связи (Relations)

## Получить связи

{% tabs %}
{% tab title="Запрос" %}
```
URL: {domain}/api/v1/catalogs/{catalogId}/records/{recordId}/relations
```

Метод: **GET**

Данный API-метод возвращает перечень каталогов, полей связи и конкретных записей, которые используют указанную запись как связанную, включая метаинформацию о каталогах, правах доступа пользователя и общее количество связанных записей.

Параметры:

* `catalogId` (number) — идентификатор каталога
* `recordId` (number) — идентификатор записи
{% endtab %}

{% tab title="Ответ" %}
Ответ: 200 OK (application/json)

```javascript
[{
    "id": "1",
    "sectionId": "1",
    "icon": "content-1",
    "title": "Название",
    "privilegeCode": "admin",
    "fieldId": "2",
    "fieldName": "Документы",
    "records": [{
            "id": "1",
            "title": "Название связанного объекта",
            "created": "2019-08-02T12:21:58.421Z"
    }],
    "recordsTotal": 1
}]
```
{% endtab %}
{% endtabs %}

## Фильтры для поиска

### **Фильтры поиска по каталогам**

`catalogId` - связи с конкретным каталогом.

Для фильтрации записей по одному каталогу необходимо использовать следующую конструкцию:

Метод: **GET**

```
URL: {domain}/api/v1/catalogs/{catalogId}/records/{recordId}/relations?catalogId={catalogId}
```

Где `catalogId` в части query-параметров - это id каталога, по которому формируется фильтрация (возвращаемый каталог).

Для фильтрации записей по **нескольким** каталогам используется конструкция следующего вида:

Метод: **GET**

```
URL: {domain}/api/v1/catalogs/{catalogId}/records/{recordId}/relations?catalogId={catalogId}&catalogId={catalogId}&catalogId={catalogId}
```

Где указывается перечисление id каталогов, по которым формируется фильтрация, через знак &.

### **Фильтры поиска по записям**

1. `fieldId` - фильтр по полю связи

Метод: **GET**

```
URL: {domain}/api/v1/catalogs/{catalogId}/records/{recordId}/relations?catalogId={catalogId}&fieldId=2
```

Где 2 - это ID поля типа “связанный каталог” в каталоге, указанном в query-параметре catalogId.

Данный фильтр используется только совместно с фильтром catalogId. При указании нескольких каталогов фильтрации необходимо учесть, что параметр fieldId применяется ко всем указанным каталогам.

Например:

```
URL: {domain}/api/v1/catalogs/27/records/1/relations?catalogId=29&catalogId=28&fieldId=6
```

В этом случае будут отфильтрованы записи:

* в каталоге 29 — по полю с id = 6 этого каталога
* в каталоге 28 — по полю с id = 6 этого каталога

То есть фильтрация выполняется отдельно внутри каждого указанного каталога по полю с соответствующим id.

2. `limit` - лимит записей

Метод: **GET**

```
URL: {domain}/api/v1/catalogs/{catalogId}/records/{recordId}/relations?limit=50
```

Допускается использование как с фильтрацией по каталогу/каталогам, так и без дополнительных фильтраций. При использовании limit совместно с фильтром по нескольким каталогам, лимит задается на каждый каталог. Например:

```
URL: {domain}/api/v1/catalogs/{catalogId}/records/{recordId}/relations?catalogId=29&catalogId=28&limit=50
```

В таком случае отобразится:

* 50 записей из каталога 29
* 50 записей из каталога 28

3. `offset` - смещение для пагинации

Метод: **GET**

```
URL: {domain}/api/v1/catalogs/{catalogId}/records/{recordId}/relations?catalogId={catalogId}&catalogId={catalogId}&offset=3
```

Где 3 - количество записей, которое необходимо пропустить для смещения (отсчёт начинается с 0). При указании нескольких каталогов фильтрации необходимо учесть, что параметр offset применяется ко всем указанным каталогам.

4. `sortField` - сортировка по полю возвращаемого каталога.

Допускается использование как с фильтрацией по каталогу/каталогам, так и без дополнительных фильтраций.

Метод: **GET**

```
URL: {domain}/api/v1/catalogs/{catalogId}/records/{recordId}/relations?sortField=7
```

Где 7 - это ID поля в каталоге, в котором используются записи исходного каталога. Сортировка выполняется по значению этого поля у возвращаемых записей. При использовании sortField совместно с фильтром по нескольким каталогам, сортировка задается на каждый каталог. Например:

```
URL: {domain}/api/v1/catalogs/{catalogId}/records/{recordId}/relations?catalogId=29&catalogId=28&sortField=7
```

В таком случае сортировка выполнится по следующему принципу:

* сортировка значений каталога 29 по его полю с id=7
* сортировка значений каталога 28 по его полю с id=7

В случае, если в одном из каталогов отсутствует поле с указанным id для сортировки, значения берутся в том порядке, как они указаны в каталоге.

5. `sortType` - тип сортировки (работает только совместно с фильтром sortField).

* `sortType=1` - по возрастанию
* `sortType=-1` - по убыванию

Метод: **GET**

```
URL: {domain}/api/v1/catalogs/{catalogId}/records/{recordId}/relations?catalogId={catalogId}&sortField=7&sortType=-1
```

6. `hiddenFields = true` - отображение скрытых полей каталога, указанного в query-параметре catalogId. Если в query-параметре не указаны каталоги фильтрации, то отображение сработает по всем связанным каталогам.

По умолчанию скрытые поля не возвращаются.

Метод: **GET**

```
URL: {domain}/api/v1/catalogs/{catalogId}/records/{recordId}/relations?catalogId={catalogId}&hiddenFields=true
```
