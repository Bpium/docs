# Компании

## Введение

Системный каталог **Компании** — это один из ключевых каталогов Бипиум, который обеспечивает мультитенантную архитектуру системы. Каждая компания в Бипиум представляет собой отдельное рабочее пространство со своей базой данных, настройками и пользователями.

Каталог **Компании** доступен администраторам серверной версии Бипиум и позволяет управлять всеми компаниями, зарегистрированными в системе.

## Назначение каталога

Каталог **Компании** используется для:

* **Изоляции данных**: каждая компания имеет свою отдельную базу данных, что обеспечивает полную изоляцию информации между разными компаниями
* **Мультидоменной поддержки**: компании могут работать на разных поддоменах или собственных доменах
* **Управления версиями**: контроль версий системы для каждой компании или группы компаний
* **Группировки компаний**: объединение компаний в группы для массовых операций и управления версиями
* **Брендирования**: настройка внешнего вида интерфейса для каждой компании (логотип, фавиконка, фон)

## Доступ к каталогу

Каталог **Компании** находится в разделе **Системные каталоги** и доступен только администраторам сервера Бипиум.

**Как открыть каталог:**

1. Войдите в систему с правами администратора
2. Перейдите в раздел **Системные каталоги** (в главном меню)
3. Выберите каталог **Компании**

## Поля каталога

### Основные поля

| Поле                  | Тип   | Описание                                                                |
| --------------------- | ----- | ----------------------------------------------------------------------- |
| **Название компании** | Текст | Отображаемое имя компании, используется в интерфейсе                    |
| **База данных**       | Текст | Строка подключения к базе данных (заполняется автоматически)            |
| **Поддомен**          | Текст | Поддомен для доступа к компании (например, `mycompany.bpium.ru`)        |
| **Домен**             | Текст | Собственный домен компании (опционально, например, `app.mycompany.com`) |
| **Создатель**         | Число | ID аккаунта пользователя, создавшего компанию                           |

### Управление версиями

| Поле               | Тип   | Описание                                                    |
| ------------------ | ----- | ----------------------------------------------------------- |
| **Группа**         | Связь | Связь с каталогом "Группы компаний" для управления версиями |
| **Текущая версия** | Связь | Связь с каталогом "Версии API", определяющая версию системы |

### Статус и метаданные

| Поле                     | Тип    | Описание                                                 |
| ------------------------ | ------ | -------------------------------------------------------- |
| **Статус**               | Список | Статус компании: "Готов" или "Обновляется"               |
| **Телефон**              | Текст  | Контактный телефон компании                              |
| **Дата создания**        | Дата   | Дата и время создания записи (заполняется автоматически) |
| **Количество записей**   | Число  | Общее количество записей во всех каталогах компании      |
| **Последняя активность** | Дата   | Дата и время последней активности пользователей          |
| **Серийный номер**       | Текст  | Серийный номер лицензии компании                         |

### Брендирование (White Label)

| Поле               | Тип  | Описание                                                        |
| ------------------ | ---- | --------------------------------------------------------------- |
| **Логотип**        | Файл | Логотип компании (PNG, рекомендуется 200x60px)                  |
| **Фавиконка**      | Файл | Иконка сайта (PNG/ICO, 64x64px)                                 |
| **Фон приложения** | Файл | Фоновое изображение интерфейса (JPG, рекомендуется 1920x1080px) |

> **Подробнее:** Документация по настройке брендирования доступна на [docs.bpium.ru/installation/whitelabel](https://docs.bpium.ru/installation/whitelabel)

## Основные операции

### Создание компании

**Создание через интерфейс:**

1. Откройте каталог **Компании**
2. Нажмите кнопку **Создать запись**
3. Заполните обязательные поля:
   * **Название компании** — название новой компании
   * **Поддомен** — уникальный поддомен (например, `newcompany`)
4. Заполните дополнительные поля (при необходимости):
   * **Телефон** — контактный телефон
   * **Группа** — группа компаний (если нужно)
   * **Текущая версия** — версия системы
5. Нажмите **Сохранить**

> **Важно:** При создании компании автоматически создается отдельная база данных. Убедитесь, что у сервера достаточно ресурсов.

**Создание при регистрации пользователя:**

При регистрации нового пользователя компания может быть создана автоматически, если пользователь указал это в форме регистрации.

### Редактирование компании

1. Откройте каталог **Компании**
2. Найдите нужную компанию в списке (можно использовать поиск)
3. Откройте запись компании двойным кликом или кнопкой "Открыть"
4. Измените нужные поля
5. Нажмите **Сохранить**

**Часто редактируемые поля:**

* **Название компании** — может быть изменено в любой момент
* **Домен** — может быть добавлен или изменен (требует настройки DNS)
* **Группа** — компанию можно переместить в другую группу
* **Текущая версия** — версию можно изменить для отдельной компании

### Поиск и фильтрация

**Поиск по тексту:**

* Используйте строку поиска вверху каталога для поиска по названию, поддомену или домену

**Фильтры:**

* **Группа** — компании, входящие в определенную группу
* **Статус** — фильтр по статусу (Готов, Обновляется)
* **Последняя активность** — компании с активностью в определенном диапазоне дат
* **Версия** — компании, использующие определенную версию

## Практические сценарии

### Настройка собственного домена

Компания может использовать собственный домен вместо поддомена. Это позволяет использовать свой бренд в адресе (например, `app.mycompany.com`).

**Как настроить:**

1. **Настройка DNS:**
   * Настройте DNS-запись типа A или CNAME, указывающую на IP-адрес сервера Бипиум
   * Обратитесь к администратору вашего домена или хостинг-провайдеру
2. **Настройка в Бипиум:**
   * Откройте запись компании в каталоге **Компании**
   * В поле **Домен** укажите полное доменное имя (например, `app.mycompany.com`)
   * Сохраните изменения
3. **Настройка веб-сервера:**
   * Настройте веб-сервер (nginx/Apache) для обработки запросов к вашему домену
   * Настройте SSL-сертификат для домена
   * Подробности см. в документации по развертыванию Бипиум

> **Примечание:** Подробные инструкции по настройке собственных доменов см. в документации по развертыванию Бипиум.

### Управление версиями

**Изменение версии для отдельной компании:**

1. Откройте запись компании в каталоге **Компании**
2. В поле **Текущая версия** выберите нужную версию из списка
3. Сохраните изменения
4. При следующем обращении к компании система автоматически выполнит обновление

> **Важно:** Обновление версии может занять некоторое время. Во время обновления статус компании автоматически изменится на "Обновляется".

**Управление версиями через группы:**

Для управления версиями множества компаний используйте группы компаний:

1. Откройте каталог **Группы компаний**
2. Создайте новую группу или откройте существующую
3. Установите версию в поле **Версия на которой должна работать компания**
4. Сохраните изменения
5. Все компании в группе автоматически получат указанную версию

Подробнее см. в документации по каталогу Группы компаний.

### Настройка брендирования

**Как загрузить элементы брендирования:**

1. Откройте запись компании в каталоге **Компании**
2. Найдите раздел **Брендирование**
3. Загрузите файлы:
   * **Логотип** — PNG, рекомендуется 200x60px, не более 2 МБ
   * **Фавиконка** — PNG/ICO, 64x64px, не более 500 КБ
   * **Фон приложения** — JPG, рекомендуется 1920x1080px, не более 5 МБ
4. Сохраните изменения

**Удаление элементов брендирования:**

1. Откройте запись компании
2. В разделе **Брендирование** удалите загруженные файлы (нажмите на иконку удаления)
3. Сохраните изменения

## Связи с другими каталогами

Каталог **Компании** связан с другими системными каталогами:

* **Аккаунты** — пользователи привязываются к компаниям через поле **Компании** в каталоге аккаунтов. Подробнее см. в документации по каталогу Аккаунты
* **Группы компаний** — компании могут быть объединены в группы для управления версиями. Подробнее см. в документации по каталогу Группы компаний
* **Версии API** — компании связаны с версиями через поле **Текущая версия**. Подробнее см. в документации по каталогу "Версии API"

## Интеграция с лицензированием

Компании связаны с системой лицензирования Бипиум:

* Лицензия определяет доступные модули и функции для компании
* Ограничения лицензии применяются на уровне компании
* Каждая компания может иметь свою конфигурацию лицензии

Серийный номер лицензии хранится в поле **Серийный номер** записи компании (если используется лицензионная версия).

## Статусы компании

Компания может находиться в следующих статусах:

| Статус          | Описание                                                                                         |
| --------------- | ------------------------------------------------------------------------------------------------ |
| **Готов**       | Компания работает нормально, все операции выполняются                                            |
| **Обновляется** | Компания находится в процессе обновления базы данных, временно недоступна для некоторых операций |

Статус **Обновляется** устанавливается автоматически системой при выполнении обновления базы данных компании. После завершения обновления статус автоматически меняется на **Готов**.

> **Важно:** Во время обновления пользователи могут испытывать задержки или временную недоступность системы. Обновление обычно занимает от нескольких секунд до нескольких минут в зависимости от объема данных.

## Часто задаваемые вопросы

### Можно ли изменить поддомен компании после создания?

Технически возможно изменить поддомен через редактирование записи компании, однако это требует дополнительной настройки на уровне веб-сервера и DNS.

**Рекомендация:** Используйте собственный домен (поле **Домен**), если требуется изменить адрес доступа к компании. Это проще и не требует изменения поддомена.

### Можно ли удалить компанию?

Удаление компании — критическая операция, которая удаляет все данные компании, включая базу данных.

**Внимание:** Удаление компании необратимо. Все данные будут потеряны.

Если вам необходимо удалить компанию, обратитесь к технической поддержке Бипиум или администратору сервера для выполнения этой операции.

### Как переместить компанию на другую версию?

Версию компании можно изменить несколькими способами:

1. **Напрямую в записи компании:**
   * Откройте запись компании
   * Измените поле **Текущая версия**
   * Сохраните изменения
2. **Через группу компаний:**
   * Добавьте компанию в группу с нужной версией
   * Версия компании автоматически обновится
3. **Изменив версию в группе:**
   * Если компания уже в группе, измените версию в записи группы
   * Версия обновится для всех компаний в группе

После изменения версии система автоматически выполнит необходимые миграции при следующем обращении к компании.

### Как работает мультидоменная установка?

В мультидоменной установке несколько компаний могут работать на одном сервере Бипиум:

* Каждая компания имеет свой поддомен или собственный домен
* Веб-сервер определяет компанию по домену запроса
* Система автоматически переключается на соответствующую базу данных компании
* Пользователи могут переключаться между компаниями через меню в интерфейсе

Это позволяет размещать множество компаний на одном сервере, что экономически эффективно для хостинг-провайдеров и крупных организаций.

### Как посмотреть статистику по компании?

Статистика по компании доступна в полях записи:

* **Количество записей** — общее количество записей во всех каталогах
* **Последняя активность** — время последней активности пользователей

Откройте запись компании в каталоге **Компании** для просмотра этой информации.

### Что делать, если компания застряла в статусе "Обновляется"?

Если компания долгое время находится в статусе "Обновляется", это может означать, что процесс обновления завис или завершился с ошибкой.

**Что делать:**

1. Проверьте логи сервера на наличие ошибок
2. Попробуйте обновить страницу — возможно, статус уже изменился
3. Если проблема сохраняется, обратитесь к технической поддержке Бипиум, предоставив:
   * ID компании
   * Время начала обновления
   * Логи сервера (если возможно)

## Поддержка

Если у вас возникли вопросы или проблемы при работе с каталогом Компании, обратитесь к технической поддержке Бипиум [support@bpium.ru](mailto:support@bpium.ru), предоставив:

* Версию Бипиум
* Описание проблемы или вопроса
* ID компании (если применимо)
* Скриншоты (если применимо)

## Дополнительные ресурсы

* Документация по настройке доменов
* [Документация по брендированию](https://docs.bpium.ru/installation/whitelabel)
* Документация по каталогу Аккаунты
* Документация по каталогу Группы компаний
