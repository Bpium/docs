# Конвертер

Используется для конвертации данных и файлов. Подразумевается два варианта использования: генерация документа на основе пользовательского шаблона, и преобразование данных из одного типа в другой, варианты конвертации и примеры использования описаны ниже.

## Свойства

### Секция «Источник данных»

**Вариант конвертации**

![](<../../../../.gitbook/assets/image (46).png>)

Список доступных вариантов для конвертации.&#x20;

* `HTML` → `PDF`: Генерация PDF буфера, принимает в качестве аргументов HTML файл, ссылку на файл или HTML разметку, вывод компонента может содержать как сам PDF файл так и его буфер.
* `Excel` → `JSON`: Генерация JSON данных используя excel таблицу. В зависимости от указанных настроек JSON будет записан в файл или данные в формате JSON будут записанные в переменную.

**Источник**

В качестве источника данных могут быть выбраны следующие:

* Файл из записи&#x20;
* URL к файлу
* Содержимое

**Файл из записи** \
****Принимает ссылку на файл шаблона. Ссылка может быть представлена как в виде указания местоположения файла в системе (`Файл из каталога`) или ссылка на файл шаблона располагающийся на доступном серверу BPIUM хосте (`URL к файлу`).

![](<../../../../.gitbook/assets/image (32).png>)

* **Каталог**\
  ****Список доступных каталогов для поиска записей. Формат: список каталогов.
* **ID записи**  \
  ****Идентификатор записи, из которой необходимо получить входные данные. Формат: **** значение/выражение.
* **Поле**\
  ****Идентификатор поля в котором находится ссылка на входной файл.

**URL к файлу**\
****URL к файлу, который находится в открытом для системы доступе. Если вариант подразумевает использование шаблона, по ссылке должен находится он.

![](<../../../../.gitbook/assets/image (42).png>)

**Содержимое**\
****Данное поле предназначено для конвертеров, которые как вводные данные могут принимать строки. К примеру, HTML->PDF  генерирует файл на основе разметки, которую получает либо из файла прикрепленного к записи, из ссылки на HTML страницу, либо из текстовой разметки которую и следует поместить в поле «содержимое».

Поле принимает как выражение, так и строки, потому в примере ниже разметка задается внутри символов «\`».

![](<../../../../.gitbook/assets/image (47).png>)

### Секция «Данные»

Ожидает данные которые будут переданы в шаблон, для вставки. Данные можно вводить как в формате «Ключ = значение», так и в виде «JSON» строки.

**Секция появляется только в случае если выбранный конвертер поддерживает формат работы с шаблоном.**

![](<../../../../.gitbook/assets/image (31).png>)

**Формат значений**  \
****Позволяет выбрать формат представления данных для шаблона. `Ключ = значение` — задать значения ключей используемых в шаблоне. `JSON-объект` — для использования js-объекта соответственно.

* Формат «ключ = значение»

![](<../../../../.gitbook/assets/image (62).png>)

* Формат «JSON — объект»

![](<../../../../.gitbook/assets/image (55).png>)

Позволяет записывать строку в формате JSON и в отличие от предыдущего формата поле ввода считаемое, поэтому в качестве любой части, в том числе и ключа, может быть использован результат вычисления.

```javascript
{
    key1: value1,      // Ключ = значение
    key2: {            // Ключ с вложенным ключом
        key3: value3    
    },
    [key4]: value4     // Переменная в качестве ключа.
}
```

### Секция «Результат»

Формат возврата готового файла.

**Сохранить как**\
****Позволяет получить результат в одном из 3х вариантов:

* Файл в запись

Сохраняет результат в поле типа Файл в указанной записи.

**Каталог**\
****Список доступных каталогов для поиска записей. Формат: список каталогов.

**ID записи**  \
****Идентификатор записи, которую надо изменить. Формат: **** значение/выражение.

**Поле**\
****Идентификатор поля, в которое надо сохранить файл. Формат: **** значение/выражение.

**Имя файла**\
****Имя под которым будет файл будет сохранен в файловом хранилище. Формат: **** значение/выражение.

**Сохранить URL файла в**\
****Имя переменной куда будет записана ссылка на файл. Формат: **** имя переменной.

![](<../../../../.gitbook/assets/image (51).png>)

* URL в переменную

**Имя файла**\
****Название под которым будет сохранен файл. Формат: **** значение/выражение

**Сохранить URL файла в**\
****Выходной параметр. Переменная, в которую будет сохранен URL файла в файловом хранилище. Формат: **** имя **** переменной.

![](<../../../../.gitbook/assets/image (48).png>)

* Содержимое в переменную

**Сохранить содержимое в**

Имя переменной куда будет записан результат работы компонента. Например, конвертер Excel->JSON может как записать результат в файл, так и сохранить его в переменную для дальнейшего использования в сценарии.

![Сохранение полученных данных в переменную result.](<../../../../.gitbook/assets/image (33).png>)

## Пограничные события

![](../../../../.gitbook/assets/boundary\_any.png)

Компонент поддерживает 2 типа пограничных событий:

* Ошибка — выход из компонента, если произошла какая-либо ошибка
* Таймаут — выход из компонента, спустя заданное ограничение по времени

Если компонент завершился с ошибкой, но на нем не было пограничного события, то процесс завершается. Сообщение ошибки возвращается в результатах процесса.
