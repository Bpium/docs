# Применяем автоматизации

У нас есть собранная минимальная система с настроенными каталогами для данных, отчётами по данным, а также настроенными правами доступа. Не хватает лишь автоматизаций. Так давайте добавим в систему еще и небольшую автоматизацию. \
Автоматизации в Бипиум - это реакции на изменения данных в системе. Поэтому мы должны описать для системы правила: \
&#x20;   1\. Изменения каких именно данных отслеживаем - за это отвечает каталог [События](../processes/events/)\
&#x20;   2\. Что после этих изменений мы должны сделать - за это отвечает каталог [Сценарии](../processes/scripts/) \
Например, мы хотим при назначении ответственного менеджера в заказ, отправить данному сотруднику уведомление в системе о назначенном заказе. Рассмотрим этот кейс ниже&#x20;

## Отправка уведомления ответственному сотруднику

Для начала нужно определиться с объектом, в котором мы отслеживаем изменения - это каталог Заказы, но нас интересуют не все данные из заказа, а лишь одно поле - Ответственный менеджер. \
Опишем это правило в каталоге События:

1. Перейдите в отдел "Управление" и в каталог "События".&#x20;
2. Нажмите кнопку "Добавить", для добавления новой записи
3. Укажите Название - оно произвольное
4. В поле "Каталог" выберите из списка каталог "Заказы"
5. Отметьте в поле "События" галочки: "Уведомление о создании записи" и "Уведомление об изменении записи"
6. В поле "Отслеживать поля" укажите id-поля "Ответственный менеджер" из каталога "Заказы"

<figure><img src="../../.gitbook/assets/2 (20).png" alt=""><figcaption><p>id-поля можно посмотреть в настройках структуры каталога. В нашем примере - это 10</p></figcaption></figure>

7. Сохраните запись

<figure><img src="../../.gitbook/assets/1 (21).png" alt=""><figcaption><p>Описанное правило</p></figcaption></figure>

Мы описали для системы правило для отслеживания изменений в нужных нам данных. Теперь необходимо описать действия, которые должны быть выполнены при возникновении данных изменений. Для этого:

1. Перейдите в каталог "Сценарии" и нажмите кнопку "Добавить" для добавления новой записи
2. Укажите Название - оно также произвольное, но мы рекомендуем, чтобы оно было информативным

<figure><img src="../../.gitbook/assets/3 (19).png" alt=""><figcaption></figcaption></figure>

3. Нажмите кнопку "Создать" в поле "Сценарий", у вас откроется BPMN-схема для описания необходимых действий в системе, с помощью готовых для этого компонентов. Подробное описание каждого компонента можно найти [по ссылке](https://docs.bpium.ru/manual/processes/scripts/components)

<figure><img src="../../.gitbook/assets/4 (20).png" alt=""><figcaption></figcaption></figure>

4. В данном примере мы будем использовать лишь пару компонентов: это [Шлюз «ИЛИ» (условное ветвление)](https://docs.bpium.ru/manual/processes/scripts/components/exclusivegateway) и [Отправить сообщение](https://docs.bpium.ru/manual/processes/scripts/components/otpravit-soobshenie). Условие нам необходимо для того, чтобы проверить а указан ли Ответственный менеджер, ведь событие будет срабатывать не только при добавлении и изменении ответственного менеджера в заказе, но и при его удалении из заказа, так как данное действие также является изменением данных в интересующем нас каталоге и поле.

<figure><img src="../../.gitbook/assets/6 (18).png" alt="" width="563"><figcaption><p> В первой ветке условия указываем, что в поле "Ответственный сотрудник" есть данные</p></figcaption></figure>

<figure><img src="../../.gitbook/assets/7 (18).png" alt="" width="563"><figcaption><p>Вторую ветку условия просто отмечаем потоком по умолчанию.<br>Сценарий пойдет по данной ветке, если не выполнится условие в первой ветке</p></figcaption></figure>

<figure><img src="../../.gitbook/assets/8 (19).png" alt="" width="563"><figcaption><p>В компоненте "Отправить сообщение" указываем данные согласно скриншоту</p></figcaption></figure>

5. Нажмите кнопку "Сохранить" в правом верхнем углу для сохранения файла сценария
6. Нажмите кнопку "Сохранить" в правом верхнем углу для сохранения записи сценария

Теперь нужно привязать событие и сценарий между собой. Откройте ранее созданное событие и в поле "Выполнить" выберите созданный сценарий, после чего сохраните запись события.

<figure><img src="../../.gitbook/assets/9 (14).png" alt=""><figcaption></figcaption></figure>

## Проверка

Перейдите в каталог Заказы и измените ответственного менеджера в одном из существующих заказов, либо создайте новый заказ, указав ответственного менеджера. У ответственного менеджера будут следующие уведомления в системе

<figure><img src="../../.gitbook/assets/10 (14).png" alt=""><figcaption></figcaption></figure>



