# Графики

График — графическое отображение распределения записей в каталоге по выбранным критериям. Графики размещены на [дашбордах](https://github.com/bpium/bpium-documentation/tree/3eee69fa93775fc88bf609ca5696e1f9581d33fa/dashboards.html).

Отображение графика&#x20;

![](../../.gitbook/assets/dashboards_widget2.png)

Сверху графиков показаны агрегатные значения: суммарное и среднее значение по данным. Среднее значение учитывает разложение по оси и сплиту (параметру «разложить по»). Оба значения учитывают все подходящие записи, а не только вошедшие на экран. Например, график по сотрудникам показывает топ 100 значений, а агрегатные значения учитывают всех.

Графики при расчёте данных учитывают [фильтры](../structure/catalogs/filter.md) каталога и видов. Это значит, что изменяя фильтры или выбирая вид, все графики перестраиваются и рассчитывают показатели исходя из записей, попавших под условия поиска.

## Создание графиков

Создавать новые графики на дашборде могут сотрудники с правом администрировать каталог.

![](../../.gitbook/assets/dashboards_add_widget.png)

## Редактирование графиков

**Размещение на дашборде.** Графики можно перемещать по экрану, перетаскивая за шапку. Графики можно изменять в размерах, растягивая за нижний-правый угол.

**Редактирование свойств.** Если нажать на название графика, откроется форма редактирования параметров построения:

![](<../../.gitbook/assets/Графики 2.png>)

## Вкладка данные

Принцип построения графика: некоторое _значение_ (например, число записей заказов) группируются по некой _оси_ (например, полю «ответственный сотрудник»). Дополнительно данные могут быть _разложены по_ некому другому полю (например, «статусу заказа»).

#### Название графика

Демонстрация графика отображается автоматически при изменении параметров построения.\
Сверху демонстрации — поле с названием графика.

#### Показать

Числовой показатель, значение по оси Y. Доступные варианты значений:

* Число записей
* Агрегатная функция по полю анкеты записи типа «число»&#x20;
* Агрегатная функция по полю анкеты записи типа «прогресс»&#x20;
* Агрегатная функция по полю анкеты записи типа «звезды»&#x20;
* Агрегатная функция по продолжительности (время активности каждого варианта значении) для полей типа «категория», «вопрос» и «набор галочек»

#### Функция (f)

Агрегатная функции для значений: суммарное значение, среднее, среднее по всем, максимальное и минимальное.

**Разница между «среднее» и «среднее по всем»:**\
При расчете среднего значения Бипиум различает значение «0» и «не указано» для числовых полей. Записи с неуказанным значением в числовом поле не учитываются при расчете среднего. Например, если в карточке Сделки есть поле Сумма, и у некоторых сделок она не указана (она еще не известна), то Сумма у этих записей не будет преобразована к «0» и эти записи не будут учтены при расчете средней суммы Сделок, иначе результат был бы искажен. При расчете «среднего по всем» пустые значения («не указано») приравнены к 0 и учитываются при расчете.

#### Считать

Параметр для группировки значений, ось X. Доступные варианты осей:

* Поля типа «дата» для группировки значений по временным интервалам
* Поля типа «категория», «вопрос» и «набор галочек» для группировки по их значениям
* Поля типа «прогресс» для группировки значений с шагом 10%
* Поля типа «звёзды» для группировки значений по их количеству
* Поля типа «сотрудник» для группировки значений по сотрудникам
* Поля типа «связанный объект» для группировки значений по связанным данным (например, заказов по клиентам)
* Поля типа «текст» для группировки значений по текстовому полю (например, по имени клиентов)
* Поля типа «число» для группировки значений по числовым показателям
* Дата создания

Возможные интервалы для группировки по дате создания и полей типа «дата»:

* час — для группировки данных по последовательным часам
* час дня — данные за всё время группируются по 24 часам суток
* день — для группировки данных по последовательным дням
* день месяца — данные за все месяца всех лет группируются по 31 дню месяцев
* неделя — для группировки данных по последовательным неделям
* неделя года — данные за все года группируются по 54 неделям года
* месяц — для группировки данных по последовательным месяцам
* месяц года — данные за все года группируются по 12 месяцев года
* год — для группировки данных по последовательным годам

Тонкость:\
Бывает, что одна запись может попасть в несколько колонок оси. Например, если осью выбрано поле категория, а запись имеет в этом поле несколько включенных значений. При этом общее число записей, отображаемое на графике, будет не совпадать с агрегатным значение сверху графика.

#### Посчитать количество уникальных записей

Параметр для построения графика по числу уникальных записей. К примеру, сотрудник может посчитать сколько всего уникальных представителей компании обращались за услугами в определенное время.

![](../../.gitbook/assets/44444444.png)

#### Сгруппировать по (сплит)

Параметр для разложения сгруппированных значений, ось Z. Доступные варианты аналогичны вариантам для оси. Параметр необязательный и может быть пустым.

Примеры:

* График суммы сделок (значение), сгруппированных по менеджерам (ось), разложенных по статусам (разложить по)
* График числа обращений (значение), сгруппированных по месяцам (ось), разложенных по звездам качества ответа (разложить по)

#### Сложить значения

Параметр включает расположение значений разложенных по полю «разложить по» друг над другом (`Stacked`), а не независимо рядом.

Параметр также влияет на отображение оси Y. Включенная опция определяет нижнюю границу оси Y начинается от 0. Выключенная опция — включает режим автоопределения нижней границы.

#### Учитывать

Параметр определяет какие данные учитывать при построении графика. Доступные варианты:

* `Все записи каталога` — будут учтены все записи каталога, даже если сотрудник не имеет доступа к их просмотру. Например, сотрудник, который видит только назначенные на него обращения сможет увидеть число всех обращений компании.
* `Только доступные сотруднику записи` — будут учтены только те записи каталога, которые доступны сотруднику. Например, сотрудник, который видит только назначенные на него обращения сможет увидеть число только своих обращений.

#### Тип

Способ визуализации данных. Доступные варианты типов отображения:

* `Столбцы` — столбчатая горизонтальная гистограмма
* `Линия` — линейный график: закрашенный, если не назначена функция «разложить по» или включен параметр «сложить значения».
* `Список` — вертикальная гистограмма
* `Пирог` — круговой график
* `Радар` — распределения по критериям
* `Число` — числовое отображение последнего значения в оси
* `Календарь` — температурное распределение по времени (пока не доступна)
* `Плоскость` — температурная таблица распределения по 2-м осям (пока не доступна)
* `Таблица` — текстовая таблица (пока не доступна)

#### Сортировка

Параметр определяется автоматически в зависимости от оси:

* Для полей типа «дата» — хронологически в обратном порядке
* Для полей типа «прогресс», «звезды» и «число» — в порядке увеличения
* Для полей типа «категория», «вопрос» и «набор галочек» — согласно размещению в анкете
* Для полей типа «сотрудник» и «связанный объект» — в порядке уменьшения значения для значений агрегированных по сумме, среднему и максимальном, и в порядке увеличения значений для значений агрегированных по минимальному значению
* Для полей типа «текст» — в алфавитном порядке

#### Лимит оси

Лимит — количество возвращаемых значений. Параметр определяется автоматически:

* Для полей типа «дата», «сотрудник» и «связанный объект» — 100 значений
* Для полей других типов — все значения

#### Лимит «сгруппировать по»

Параметр определяется автоматически:

* Для полей типа «дата», «сотрудник» и «связанный объект» — 10 значений
* Для полей других типов — все значения

### Вкладка фильтры

![](../../.gitbook/assets/dashboards_filters.png)

В этой вкладке находится свой собственный фильтр для каждого графика. Выбирая фильтры, график перестраивается и рассчитывает показатели исходя из записей, попавших под условия поиска. Задавая фильтры у дашборда, графики перестроятся с учетом их собственных фильтров.

